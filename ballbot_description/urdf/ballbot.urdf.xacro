<?xml version="1.0"?>
<robot name="collector_bot">

  <!-- =================================================================== -->
  <!-- |                           MATERIALS                             | -->
  <!-- =================================================================== -->

  <material name="blue">
    <color rgba="0.0 0.0 0.8 1.0"/>
  </material>

  <material name="black">
    <color rgba="0.0 0.0 0.0 1.0"/>
  </material>

  <material name="grey">
    <color rgba="0.5 0.5 0.5 1.0"/>
  </material>

  <material name="green">
    <color rgba="0.0 0.8 0.0 1.0"/>
  </material>

  <material name="red">
    <color rgba="0.8 0.0 0.0 1.0"/>
  </material>

  <!-- =================================================================== -->
  <!-- |                            BASE LINK (CHASSIS)                  | -->
  <!-- =================================================================== -->

  <link name="base_link">
    <visual>
      <!-- 
         New Height: 30cm (0.3).
         Ground is Z=0. Wheel radius is 0.05. Chassis bottom sits at Z=0.05.
         Center of chassis is Z = 0.05 + (0.3 / 2) = 0.20.
      -->
      <origin xyz="0 0 0.20" rpy="0 0 0"/>
      <geometry>
        <!-- 50cm wide (Y), 50cm long (X), 30cm tall (Z) -->
        <box size="0.5 0.5 0.3"/>
      </geometry>
      <material name="blue"/>
    </visual>
    <collision>
      <origin xyz="0 0 0.20" rpy="0 0 0"/>
      <geometry>
        <box size="0.5 0.5 0.3"/>
      </geometry>
    </collision>
    <inertial>
      <origin xyz="0 0 0.20" rpy="0 0 0"/>
      <!-- Mass reduced (approx 3kg) for smaller volume -->
      <mass value="3.0"/>
      <inertia
        ixx="0.085" ixy="0.0" ixz="0.0"
        iyy="0.085" iyz="0.0"
        izz="0.125"/>
    </inertial>
  </link>

  <!-- =================================================================== -->
  <!-- |                         DRIVE WHEELS (LEFT & RIGHT)             | -->
  <!-- =================================================================== -->

  <!-- Left Wheel -->
  <link name="left_wheel">
    <visual>
      <!-- Visuals are rotated 90 deg on X to align with the Y-axis joint -->
      <origin xyz="0 0 0" rpy="1.5707 0 0" />
      <geometry>
        <!-- 10cm diameter, 4cm wide -->
        <cylinder radius="0.05" length="0.04"/>
      </geometry>
      <material name="black"/>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="1.5707 0 0" />
      <geometry>
        <cylinder radius="0.05" length="0.04"/>
      </geometry>
    </collision>
    <inertial>
      <!-- Mass of 0.5kg for the wheel -->
      <mass value="0.5"/>
      <inertia
        ixx="0.000378" ixy="0.0" ixz="0.0"
        iyy="0.000378" iyz="0.0"
        izz="0.000625"/>
    </inertial>
  </link>

  <joint name="left_wheel_joint" type="continuous">
    <parent link="base_link"/>
    <child link="left_wheel"/>
    <!-- Positioned just outside the 50cm chassis on the Y-axis -->
    <!-- Z=0.05 places the axle 5cm above ground (0,0,0) -->
    <origin xyz="0 0.27 0.05" rpy="0 0 0"/>
    <!-- Spin axis is Y -->
    <axis xyz="0 1 0"/>
  </joint>

  <!-- Right Wheel -->
  <link name="right_wheel">
    <visual>
      <origin xyz="0 0 0" rpy="1.5707 0 0" />
      <geometry>
        <cylinder radius="0.05" length="0.04"/>
      </geometry>
      <material name="black"/>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="1.5707 0 0" />
      <geometry>
        <cylinder radius="0.05" length="0.04"/>
      </geometry>
    </collision>
    <inertial>
      <mass value="0.5"/>
      <inertia
        ixx="0.000378" ixy="0.0" ixz="0.0"
        iyy="0.000378" iyz="0.0"
        izz="0.000625"/>
    </inertial>
  </link>

  <joint name="right_wheel_joint" type="continuous">
    <parent link="base_link"/>
    <child link="right_wheel"/>
    <!-- Z=0.05 places the axle 5cm above ground (0,0,0) -->
    <origin xyz="0 -0.27 0.05" rpy="0 0 0"/>
    <axis xyz="0 1 0"/>
  </joint>

  <!-- =================================================================== -->
  <!-- |                           CASTOR WHEEL                          | -->
  <!-- =================================================================== -->

  <link name="castor_wheel">
    <visual>
      <geometry>
        <!-- 8cm diameter sphere -->
        <sphere radius="0.04"/>
      </geometry>
      <material name="grey"/>
    </visual>
    <collision>
      <geometry>
        <sphere radius="0.04"/>
      </geometry>
    </collision>
    <inertial>
      <!-- Mass of 0.2kg -->
      <mass value="0.2"/>
      <inertia
        ixx="0.000128" ixy="0.0" ixz="0.0"
        iyy="0.000128" iyz="0.0"
        izz="0.000128"/>
    </inertial>
  </link>

  <joint name="castor_wheel_joint" type="fixed">
    <parent link="base_link"/>
    <child link="castor_wheel"/>
    <!--
      Ground is Z=0.
      Castor (r=0.04) center must be at Z=0.04 to touch ground.
      Rear position: X = -0.2
    -->
    <origin xyz="-0.2 0 0.04" rpy="0 0 0"/>
  </joint>

  <!-- =================================================================== -->
  <!-- |                       VERTICAL POLE & LIDAR                     | -->
  <!-- =================================================================== -->

  <link name="vertical_pole">
    <visual>
      <geometry>
        <!-- Shortened pole: 5cm tall, 4cm diameter -->
        <cylinder radius="0.02" length="0.05"/>
      </geometry>
      <material name="grey"/>
    </visual>
    <collision>
      <geometry>
        <cylinder radius="0.02" length="0.05"/>
      </geometry>
    </collision>
    <inertial>
      <!-- Mass reduced to 0.1kg -->
      <mass value="0.1"/>
      <inertia
        ixx="0.00003" ixy="0.0" ixz="0.0"
        iyy="0.00003" iyz="0.0"
        izz="0.00002"/>
    </inertial>
  </link>

  <joint name="vertical_pole_joint" type="fixed">
    <parent link="base_link"/>
    <child link="vertical_pole"/>
    <!--
      Attached to the center (X=0, Y=0).
      Chassis bottom Z=0.05. Chassis height 0.3. Top is Z=0.35.
      Pole center (0.05 / 2 = 0.025) is placed at Z = 0.35 + 0.025 = 0.375.
    -->
    <origin xyz="0 0 0.375" rpy="0 0 0"/>
  </joint>

  <!-- Lidar Link -->
  <link name="lidar">
    <visual>
      <geometry>
        <cylinder radius="0.05" length="0.05"/>
      </geometry>
      <material name="red"/>
    </visual>
    <collision>
      <geometry>
        <cylinder radius="0.05" length="0.05"/>
      </geometry>
    </collision>
    <inertial>
      <!-- Mass of 0.3kg -->
      <mass value="0.3"/>
      <inertia
        ixx="0.00025" ixy="0.0" ixz="0.0"
        iyy="0.00025" iyz="0.0"
        izz="0.000375"/>
    </inertial>
  </link>

  <joint name="lidar_joint" type="fixed">
    <parent link="vertical_pole"/>
    <child link="lidar"/>
    <!--
      Placed on top of the short pole.
      Pole's local top is at Z=0.025.
      Lidar center (0.05 / 2 = 0.025) is placed at
      Z = 0.025 + 0.025 = 0.05.
    -->
    <origin xyz="0 0 0.05" rpy="0 0 0"/>
  </joint>

  <!-- =================================================================== -->
  <!-- |                       BALL COLLECTOR ARMS (V-SHAPE)             | -->
  <!-- =================================================================== -->
  <!--  -->
  <!-- Left Arm -->
  <link name="left_arm">
    <visual>
      <geometry>
        <!-- 60cm long, 5cm wide, 30cm tall -->
        <box size="0.6 0.05 0.3"/>
      </geometry>
      <material name="green"/>
    </visual>
    <collision>
      <geometry>
        <box size="0.6 0.05 0.3"/>
      </geometry>
    </collision>
    <inertial>
      <!-- Mass reduced to 1.5kg -->
      <mass value="1.5"/>
      <inertia
        ixx="0.0115" ixy="0.0" ixz="0.0"
        iyy="0.0562" iyz="0.0"
        izz="0.0453"/>
    </inertial>
  </link>

  <joint name="left_arm_joint" type="fixed">
    <parent link="base_link"/>
    <child link="left_arm"/>
    <!--
      Attached to the front-left.
      Chassis center Z=0.20. Arm center Z=0.20 (aligned).
    -->
    <origin xyz="0.51 0.40 0.20" rpy="0 0 0.523"/>
  </joint>

  <!-- Right Arm -->
  <link name="right_arm">
    <visual>
      <geometry>
        <box size="0.6 0.05 0.3"/>
      </geometry>
      <material name="green"/>
    </visual>
    <collision>
      <geometry>
        <box size="0.6 0.05 0.3"/>
      </geometry>
    </collision>
    <inertial>
      <!-- Mass reduced to 1.5kg -->
      <mass value="1.5"/>
      <inertia
        ixx="0.0115" ixy="0.0" ixz="0.0"
        iyy="0.0562" iyz="0.0"
        izz="0.0453"/>
    </inertial>
  </link>

  <joint name="right_arm_joint" type="fixed">
    <parent link="base_link"/>
    <child link="right_arm"/>
    <!-- Chassis center Z=0.20. Arm center Z=0.20 (aligned). -->
    <origin xyz="0.51 -0.40 0.20" rpy="0 0 -0.523"/>
  </joint>

  <!-- =================================================================== -->
  <!-- |                       COLLECTOR FLAPS                           | -->
  <!-- =================================================================== -->

  <!-- Left Flap -->
  <link name="left_flap">
    <visual>
      <!-- Shift geometry 15cm so pivot is at the end, not center -->
      <origin xyz="0.15 0 0" rpy="0 0 0"/>
      <geometry>
        <!-- 30cm long, 2cm thick, 30cm tall -->
        <box size="0.3 0.02 0.3"/>
      </geometry>
      <material name="red"/>
    </visual>
    <collision>
      <origin xyz="0.15 0 0" rpy="0 0 0"/>
      <geometry>
        <box size="0.3 0.02 0.3"/>
      </geometry>
    </collision>
    <inertial>
      <!-- Center of mass also shifts -->
      <origin xyz="0.15 0 0" rpy="0 0 0"/>
      <mass value="0.3"/>
      <inertia
        ixx="0.00226" ixy="0.0" ixz="0.0"
        iyy="0.0045" iyz="0.0"
        izz="0.00226"/>
    </inertial>
  </link>

  <joint name="left_flap_joint" type="revolute">
    <parent link="left_arm"/>
    <child link="left_flap"/>
    <!-- Attached to the end of the arm (arm length 0.6, center at 0 -> end at 0.3) -->
    <origin xyz="0.3 0 0" rpy="0 0 0"/>
    <axis xyz="0 0 1"/>
    <!-- Swing limits: -90 to 0 degrees (inward/forward mirrored) -->
    <limit lower="-1.57" upper="0.0" effort="10.0" velocity="1.0"/>
  </joint>

  <!-- Right Flap -->
  <link name="right_flap">
    <visual>
      <!-- Shift geometry 15cm so pivot is at the end -->
      <origin xyz="0.15 0 0" rpy="0 0 0"/>
      <geometry>
        <box size="0.3 0.02 0.3"/>
      </geometry>
      <material name="red"/>
    </visual>
    <collision>
      <origin xyz="0.15 0 0" rpy="0 0 0"/>
      <geometry>
        <box size="0.3 0.02 0.3"/>
      </geometry>
    </collision>
    <inertial>
      <origin xyz="0.15 0 0" rpy="0 0 0"/>
      <mass value="0.3"/>
      <inertia
        ixx="0.00226" ixy="0.0" ixz="0.0"
        iyy="0.0045" iyz="0.0"
        izz="0.00226"/>
    </inertial>
  </link>

  <joint name="right_flap_joint" type="revolute">
    <parent link="right_arm"/>
    <child link="right_flap"/>
    <origin xyz="0.3 0 0" rpy="0 0 0"/>
    <axis xyz="0 0 1"/>
    <!-- Swing limits: 0 to 90 degrees (inward/forward) -->
    <limit lower="0.0" upper="1.57" effort="10.0" velocity="1.0"/>
  </joint>

</robot>